<?php
    $items = [
        [
            "name" => "Assassin's Creed Shadows Special Edition PS5",
            "image" => "assassin's_creed_ps5.png",
            "disponibility" => "En stock",
            "type" => "Jeux vidéo",
            "id" => 1,
            "description" => "Plongez dans l'univers d'Assassin's Creed avec cette édition spéciale pour PS5. Découvrez des graphismes époustouflants et une histoire captivante.",
            "price" => 59.99,
            "stock" => 10,
            "editeur" => "Ubisoft",
            "supplier" => [
                "name" => "Ubisoft",
                "address" => "28 Rue Armand Carrel, 75019 Paris, France",
                "siret" => "480 262 409 00036"
            ]
        ],
        [
            "name" => "Astro Bot PS5",
            "image" => "astro_bot_ps5.jpg",
            "disponibility" => "Faible en stock",
            "type" => "Jeux vidéo",
            "id" => 2,
            "description" => "Suite à la destruction du vaisseau-mère PS5®, ASTRO et son équipage ont été éparpillés à travers de nombreuses galaxies.",
            "price" => 49.99,
            "stock" => 5,
            "editeur" => "Sony Interactive Entertainment",
            "supplier" => [
                "name" => "Sony Interactive Entertainment",
                "address" => "2207 Bridgepointe Pkwy, San Mateo, CA 94404, USA",
                "siret" => "123 456 789 00012"
            ]
        ],
        [
            "name" => "Silent Hill 2 PS5",
            "image" => "silent_hill_2_ps5.jpg",
            "disponibility" => "Stock épuisé",
            "type" => "Jeux vidéo",
            "id" => 3,
            "description" => "Revivez l'horreur psychologique avec le remake de Silent Hill 2, un classique du survival horror.",
            "price" => 69.99,
            "stock" => 0,
            "editeur" => "Konami",
            "supplier" => [
                "name" => "Konami",
                "address" => "1-11-1 Ginza, Chuo-ku, Tokyo 104-0061, Japon",
                "siret" => "987 654 321 00098"
            ]
        ],
        [
            "name" => "Death Stranding 2 On the Beach PS5",
            "image" => "death_stranding_2_ps5.jpg",
            "disponibility" => "En précommande",
            "type" => "Jeux d'occasion",
            "id" => 4,
            "description" => "Découvrez la suite tant attendue de Death Stranding, une aventure unique et immersive.",
            "price" => 79.99,
            "stock" => 0,
            "editeur" => "Kojima Productions",
            "supplier" => [
                "name" => "Kojima Productions",
                "address" => "Roppongi Hills, Minato City, Tokyo, Japon",
                "siret" => "456 789 123 00045"
            ]
        ],
        [
            "name" => "The Last of Us Part II PS5",
            "image" => "last_of_us_2_ps5.jpg",
            "disponibility" => "En stock",
            "type" => "Jeux vidéo",
            "id" => 5,
            "description" => "Rejoignez Ellie dans une quête de vengeance et de rédemption dans ce chef-d'œuvre narratif.",
            "price" => 39.99,
            "stock" => 15,
            "editeur" => "Naughty Dog",
            "supplier" => [
                "name" => "Naughty Dog",
                "address" => "2425 Olympic Blvd, Santa Monica, CA 90404, USA",
                "siret" => "321 654 987 00021"
            ]
        ],
        [
            "name" => "Spider-Man 2 PS5",
            "image" => "spiderman_2_ps5.jpg",
            "disponibility" => "En précommande",
            "type" => "Jeux vidéo",
            "id" => 6,
            "description" => "Incarnez Peter Parker et Miles Morales dans cette nouvelle aventure pleine d'action.",
            "price" => 69.99,
            "stock" => 0,
            "editeur" => "Insomniac Games",
            "supplier" => [
                "name" => "Insomniac Games",
                "address" => "2255 N Ontario St, Burbank, CA 91504, USA",
                "siret" => "654 321 987 00032"
            ]
        ],
        [
            "name" => "Nintendo Switch OLED",
            "image" => "switch_oled.jpg",
            "disponibility" => "En stock",
            "type" => "Consoles",
            "id" => 7,
            "description" => "Profitez d'une expérience de jeu améliorée avec l'écran OLED vibrant de la Nintendo Switch.",
            "price" => 349.99,
            "stock" => 20,
            "editeur" => "Nintendo",
            "supplier" => [
                "name" => "Nintendo",
                "address" => "11-1 Kamitoba-hokotate-cho, Minami-ku, Kyoto, Japon",
                "siret" => "123 987 654 00011"
            ]
        ],
        [
            "name" => "Manette DualSense Edge PS5",
            "image" => "dualsense_edge.jpg",
            "disponibility" => "Faible en stock",
            "type" => "Accessoires",
            "id" => 8,
            "description" => "Découvrez la manette DualSense Edge, conçue pour une expérience de jeu personnalisée.",
            "price" => 199.99,
            "stock" => 3,
            "editeur" => "Sony Interactive Entertainment",
            "supplier" => [
                "name" => "Sony Interactive Entertainment",
                "address" => "2207 Bridgepointe Pkwy, San Mateo, CA 94404, USA",
                "siret" => "123 456 789 00012"
            ]
        ],
        [
            "name" => "Figurine Geralt de Riv Witcher 3",
            "image" => "geralt_figurine.jpg",
            "disponibility" => "En stock",
            "type" => "Produits dérivés",
            "id" => 9,
            "description" => "Ajoutez cette figurine détaillée de Geralt de Riv à votre collection.",
            "price" => 49.99,
            "stock" => 25,
            "editeur" => "CD Projekt Red",
            "supplier" => [
                "name" => "CD Projekt Red",
                "address" => "Jagiellońska 74, 03-301 Varsovie, Pologne",
                "siret" => "789 654 321 00077"
            ]
        ],
        [
            "name" => "Carte PSN 50€",
            "image" => "psn_card_50.png",
            "disponibility" => "En stock",
            "type" => "Carte & Abonnements",
            "id" => 10,
            "description" => "Rechargez votre compte PlayStation Network avec cette carte de 50€.",
            "price" => 50.00,
            "stock" => 100,
            "editeur" => "Sony Interactive Entertainment",
            "supplier" => [
                "name" => "Sony Interactive Entertainment",
                "address" => "2207 Bridgepointe Pkwy, San Mateo, CA 94404, USA",
                "siret" => "123 456 789 00012"
            ]
        ],
    ];

    //On creer un filtre par défaut
    $selectedType = $_GET['type'] ?? 'all';

    //On creer le tableau filtré
    $filteredItems = array_filter($items, function ($item) use ($selectedType) {
        return $selectedType === 'all' || $item['type'] === $selectedType;
    });
?>

<div id="itemsContainer">
    <?php foreach ($filteredItems as $item): ?>

    <div class="itemContainer" data-id="<?php echo htmlspecialchars($item['id']); ?>">
        <div class="itemPictureContainer">
            <img
            src="./public/img/items/<?php echo htmlspecialchars($item['image']); ?>"
            alt="<?php echo htmlspecialchars($item['name']); ?>"
            class="itemPicture"
            />
        </div>
        <div class="itemNameContainer">
            <p class="itemName">
                <?php echo htmlspecialchars($item['name']); ?>
            </p>
        </div>
        <div
        class="itemDisponibilityContainer"
        style="
            <?php
                if ($item['disponibility'] === 'En stock') {
                    echo 'background-color: #009A1C;';
                } elseif ($item['disponibility'] === 'Faible en stock') {
                    echo 'background-color: #DC6C0A;';
                } elseif ($item['disponibility'] === 'Stock épuisé') {
                    echo 'background-color: #E12200;';
                } elseif ($item['disponibility'] === 'En précommande') {
                    echo 'background-color: #391461;';
                }
            ?>">
            <p class="itemDisponibility">
                <?php echo htmlspecialchars($item['disponibility']); ?>
            </p>
        </div>
    </div>

    <?php endforeach; ?>
</div>

<script>
    const items = <?php echo json_encode($items, JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP); ?>;
</script>